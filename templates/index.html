{%extends "nav.html"%}
{% block head %}
    <!-- <link rel="stylesheet" href="styles.css" /> -->
    <script src="https://d3js.org/d3.v6.js"></script>

    <style>
      .chart-container {
        float: left; /* Float the containers to position them side by side */
        width: 50%; /* Set the width of each container to 50% to fit two containers side by side */
      }
    </style>
    
    {% endblock %}
    {% block content %}

    <div id="chart1" class="chart-container"></div>
    <div id="chart2" class="chart-container"></div>
    <div id="chart3" class="chart-container"></div>
    <div id="chart4" class="chart-container"></div>
    <div id="chart5" class="chart-container"></div>
    <div id="chart6" class="chart-container"></div>
    <div id="chart7" class="chart-container"></div>
    <!-- <div id="chart6" class="chart-container"></div> -->
   
    <script id = "town"> // Function to create a bar chart
      function createTownChart(data, title, containerId) {
        var w = 700;
        var h = 500;
        var margin = {
          top: 50,
          bottom: 50,
          left: 50, // Adjusted to accommodate longer x-axis labels
          right: 50,
        };
        var width = w - margin.left - margin.right;
        var height = h - margin.top - margin.bottom;
      
        // Create container div for chart
        var container = d3.select("#" + containerId).append("div").classed("chart-container", true);
      
        // Create SVG container
        var svg = container
          .append("svg")
          .attr("width", w)
          .attr("height", h);
      
        // Append title
        svg.append("text")
          .attr("x", w / 2)
          .attr("y", margin.top / 2)
          .attr("text-anchor", "middle")
          .style("font-size", "20px")
          .text(title);
      
        // Define scales and axes
        var x = d3
          .scaleBand()
          .domain(data.map(function(d) { return d[0]; }))
          .range([margin.left, width])
          .padding(0.1);
      
        var y = d3
          .scaleLinear()
          .domain([0, d3.max(data, function(d) { return d[1]; })])
          .range([height, margin.top]);
      
        var xAxis = d3.axisBottom().scale(x);
        var yAxis = d3.axisLeft().scale(y);
      
        // Append X axis
        svg.append("g")
          .attr("class", "x-axis")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis)
          .selectAll("text")
          .style("text-anchor", "end")
          .attr("dx", "-.8em")
          .attr("dy", ".15em")
          .attr("transform", "rotate(-45)");
      
        // Append Y axis
        svg.append("g")
          .attr("class", "y-axis")
          .attr("transform", "translate(" + margin.left + ",0)")
          .call(yAxis);
      
        // Append bars
        svg.selectAll(".bar")
          .data(data)
          .enter()
          .append("rect")
          .attr("class", "bar")
          .attr("x", function(d) { return x(d[0]); })
          .attr("width", x.bandwidth())
          .attr("y", height)
          .attr("height", 0)
          .attr("fill", "steelblue")
          .on("mouseover", function () {
            d3.select(this).attr("fill", "red");
          })
          .on("mouseout", function () {
            d3.select(this).transition("colorfade")
              .duration(250)
              .attr("fill", "steelblue");
          })
          .transition()
          .duration(1000)
          .attr("y", function(d) { return y(d[1]); })
          .attr("height", function(d) { return height - y(d[1]); });
      
        // Append tooltips
        svg.selectAll("rect")
          .append("title")
          .text(function(d) { return d[0] + ": $" + d[1].toFixed(2); });
      }
      var data = {{ data_json | safe }};
      // Load data and create bar charts
     
      
        // Convert value strings to numbers
        data.forEach(function(d) {
          d.resale_price = +d.resale_price;
        });
      
        // Calculate average resale price for each town
        var averagePrices = d3.rollups(
          data,
          (v) => d3.mean(v, (d) => d.resale_price),
          (d) => d.town
        );
      
        // Sort averagePrices by average resale price
        averagePrices.sort(function(a, b) {
          return d3.descending(a[1], b[1]);
        });
      
        // Create bar chart for chart1
        createTownChart(averagePrices, "Average Resale Price vs. Town", "chart1");
      
  
      function createFlatTypeChart(data, title, containerId) {
        var w = 700;
        var h = 500;
        var margin = {
          top: 50,
          bottom: 50,
          left: 50, // Adjusted to accommodate longer x-axis labels
          right: 50,
        };
        var width = w - margin.left - margin.right;
        var height = h - margin.top - margin.bottom;
      
        // Create container div for chart
        var container = d3.select("#" + containerId).append("div").classed("chart-container", true);
    
        // Create SVG container
        var svg = container
          .append("svg")
          .attr("width", w)
          .attr("height", h);
      
        // Append title
        svg.append("text")
          .attr("x", w / 2)
          .attr("y", margin.top / 2)
          .attr("text-anchor", "middle")
          .style("font-size", "20px")
          .text(title);
      
        // Define scales and axes
        var x = d3
          .scaleBand()
          .domain(data.map(function(d) { return d[0]; }))
          .range([margin.left, width])
          .padding(0.1);
      
        var y = d3
          .scaleLinear()
          .domain([0, d3.max(data, function(d) { return d[1]; })])
          .range([height, margin.top]);
      
        var xAxis = d3.axisBottom().scale(x);
        var yAxis = d3.axisLeft().scale(y);
      
        // Append X axis
        svg.append("g")
          .attr("class", "x-axis")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis)
          .selectAll("text")
          .style("text-anchor", "end")
          .attr("dx", "-.8em")
          .attr("dy", ".15em")
          .attr("transform", "rotate(-45)");
      
        // Append Y axis
        svg.append("g")
          .attr("class", "y-axis")
          .attr("transform", "translate(" + margin.left + ",0)")
          .call(yAxis);
      
        // Append bars
        svg.selectAll(".bar")
          .data(data)
          .enter()
          .append("rect")
          .attr("class", "bar")
          .attr("x", function(d) { return x(d[0]); })
          .attr("width", x.bandwidth())
          .attr("y", height)
          .attr("height", 0)
          .attr("fill", "steelblue")
          .on("mouseover", function () {
            d3.select(this).attr("fill", "red");
          })
          .on("mouseout", function () {
            d3.select(this).transition("colorfade")
              .duration(250)
              .attr("fill", "steelblue");
          })
          .transition()
          .duration(1000)
          .attr("y", function(d) { return y(d[1]); })
          .attr("height", function(d) { return height - y(d[1]); });
      
        // Append tooltips
        svg.selectAll("rect")
          .append("title")
          .text(function(d) { return d[0] + ": $" + d[1].toFixed(2); });
      }
      
      // Load data and create bar charts
      
      
        // Convert value strings to numbers
        data.forEach(function(d) {
          d.resale_price = +d.resale_price;
        });
      
        // Calculate average resale price for each town
        var averagePrices = d3.rollups(
          data,
          (v) => d3.mean(v, (d) => d.resale_price),
          (d) => d.flat_type
        );
      
        // Sort averagePrices by average resale price
        averagePrices.sort(function(a, b) {
          return d3.descending(a[1], b[1]);
        });
      
        // Create bar chart for chart1
        createFlatTypeChart(averagePrices, "Average Resale Price vs. Flat Type", "chart3");
     
        // Function to create a bar chart
function createStoreyRangeChart(data, title, containerId) {
  var w = 700;
  var h = 500;
  var margin = {
    top: 50,
    bottom: 50,
    left: 50, // Adjusted to accommodate longer x-axis labels
    right: 50,
  };
  var width = w - margin.left - margin.right;
  var height = h - margin.top - margin.bottom;

  // Create container div for chart
  var container = d3.select("#" + containerId).append("div").classed("chart-container", true);

  // Create SVG container
  var svg = container
    .append("svg")
    .attr("width", w)
    .attr("height", h);

  // Append title
  svg.append("text")
    .attr("x", w / 2)
    .attr("y", margin.top / 2)
    .attr("text-anchor", "middle")
    .style("font-size", "20px")
    .text(title);

  // Define scales and axes
  var x = d3
    .scaleBand()
    .domain(data.map(function(d) { return d[0]; }))
    .range([margin.left, width])
    .padding(0.1);

  var y = d3
    .scaleLinear()
    .domain([0, d3.max(data, function(d) { return d[1]; })])
    .range([height, margin.top]);

  var xAxis = d3.axisBottom().scale(x);
  var yAxis = d3.axisLeft().scale(y);

  // Append X axis
  svg.append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis)
    .selectAll("text")
    .style("text-anchor", "end")
    .attr("dx", "-.8em")
    .attr("dy", ".15em")
    .attr("transform", "rotate(-45)");

  // Append Y axis
  svg.append("g")
    .attr("class", "y-axis")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(yAxis);

  // Append bars
  svg.selectAll(".bar")
    .data(data)
    .enter()
    .append("rect")
    .attr("class", "bar")
    .attr("x", function(d) { return x(d[0]); })
    .attr("width", x.bandwidth())
    .attr("y", height)
    .attr("height", 0)
    .attr("fill", "steelblue")
    .on("mouseover", function () {
      d3.select(this).attr("fill", "red");
    })
    .on("mouseout", function () {
      d3.select(this).transition("colorfade")
        .duration(250)
        .attr("fill", "steelblue");
    })
    .transition()
    .duration(1000)
    .attr("y", function(d) { return y(d[1]); })
    .attr("height", function(d) { return height - y(d[1]); });

  // Append tooltips
  svg.selectAll("rect")
    .append("title")
    .text(function(d) { return d[0] + ": $" + d[1].toFixed(2); });
}

// Load data and create bar charts


  // Convert value strings to numbers
  data.forEach(function(d) {
    d.resale_price = +d.resale_price;
  });

  // Calculate average resale price for each town
  var averagePrices = d3.rollups(
    data,
    (v) => d3.mean(v, (d) => d.resale_price),
    (d) => d.storey_range
  );

  // Sort averagePrices by average resale price
  averagePrices.sort(function(a, b) {
    return d3.descending(a[1], b[1]);
  });

  // Create bar chart for chart1
  createStoreyRangeChart(averagePrices, "Average Resale Price vs. Storey Range", "chart2");

  // Function to create a bar chart
function createFlatModelChart(data, title, containerId) {
  var w = 700;
  var h = 500;
  var margin = {
    top: 50,
    bottom: 50,
    left: 50, // Adjusted to accommodate longer x-axis labels
    right: 50,
  };
  var width = w - margin.left - margin.right;
  var height = h - margin.top - margin.bottom;

  // Create container div for chart
  var container = d3.select("#" + containerId).append("div").classed("chart-container", true);

  // Create SVG container
  var svg = container
    .append("svg")
    .attr("width", w)
    .attr("height", h);

  // Append title
  svg.append("text")
    .attr("x", w / 2)
    .attr("y", margin.top / 2)
    .attr("text-anchor", "middle")
    .style("font-size", "20px")
    .text(title);

  // Define scales and axes
  var x = d3
    .scaleBand()
    .domain(data.map(function(d) { return d[0]; }))
    .range([margin.left, width])
    .padding(0.1);

  var y = d3
    .scaleLinear()
    .domain([0, d3.max(data, function(d) { return d[1]; })])
    .range([height, margin.top]);

  var xAxis = d3.axisBottom().scale(x);
  var yAxis = d3.axisLeft().scale(y);

  // Append X axis
  svg.append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis)
    .selectAll("text")
    .style("text-anchor", "end")
    .attr("dx", "-.8em")
    .attr("dy", ".15em")
    .attr("transform", "rotate(-45)");

  // Append Y axis
  svg.append("g")
    .attr("class", "y-axis")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(yAxis);

  // Append bars
  svg.selectAll(".bar")
    .data(data)
    .enter()
    .append("rect")
    .attr("class", "bar")
    .attr("x", function(d) { return x(d[0]); })
    .attr("width", x.bandwidth())
    .attr("y", height)
    .attr("height", 0)
    .attr("fill", "steelblue")
    .on("mouseover", function () {
      d3.select(this).attr("fill", "red");
    })
    .on("mouseout", function () {
      d3.select(this).transition("colorfade")
        .duration(250)
        .attr("fill", "steelblue");
    })
    .transition()
    .duration(1000)
    .attr("y", function(d) { return y(d[1]); })
    .attr("height", function(d) { return height - y(d[1]); });

  // Append tooltips
  svg.selectAll("rect")
    .append("title")
    .text(function(d) { return d[0] + ": $" + d[1].toFixed(2); });
}

// Load data and create bar charts


  // Convert value strings to numbers
  data.forEach(function(d) {
    d.resale_price = +d.resale_price;
  });

  // Calculate average resale price for each town
  var averagePrices = d3.rollups(
    data,
    (v) => d3.mean(v, (d) => d.resale_price),
    (d) => d.flat_model
  );

  // Sort averagePrices by average resale price
  averagePrices.sort(function(a, b) {
    return d3.descending(a[1], b[1]);
  });

  // Create bar chart for chart1
  createFlatModelChart(averagePrices, "Average Resale Price vs. Flat Model", "chart4");
  // Function to calculate average resale price for each floor area sqm
  // Function to calculate average resale price for each floor area sqm

function calculateAverageResalePrice(data) {
  // Create a map to store total resale price and count of data points for each floor area sqm
  var priceMap = new Map();

  // Iterate through the data to populate the priceMap
  data.forEach(function (d) {
    var floorArea = d.floor_area_sqm;
    var price = d.resale_price;

    // If floor area is not already in the map, initialize its values
    if (!priceMap.has(floorArea)) {
      priceMap.set(floorArea, { total: 0, count: 0 });
    }

    // Update the total resale price and count for the floor area
    var floorAreaData = priceMap.get(floorArea);
    floorAreaData.total += price;
    floorAreaData.count++;
    priceMap.set(floorArea, floorAreaData);
  });

  // Calculate the average resale price for each floor area
  var averagePrices = [];
  priceMap.forEach(function (value, key) {
    var averagePrice = value.total / value.count;
    averagePrices.push([key, averagePrice]);
  });

  return averagePrices;
}

// Function to calculate linear regression parameters (slope and intercept)
function calculateLinearRegression(data) {
  // Calculate mean of x and y values
  var xMean = d3.mean(data, function (d) {
    return d[0];
  });
  var yMean = d3.mean(data, function (d) {
    return d[1];
  });

  // Calculate numerator and denominator of slope
  var numerator = d3.sum(data, function (d) {
    return (d[0] - xMean) * (d[1] - yMean);
  });
  var denominator = d3.sum(data, function (d) {
    return Math.pow(d[0] - xMean, 2);
  });

  // Calculate slope and intercept
  var slope = numerator / denominator;
  var intercept = yMean - slope * xMean;

  return { slope: slope, intercept: intercept };
}

// Function to create a scatter plot
function createFloorAreaSqmPlot(data, title, containerId) {
  var w = 700;
  var h = 500;
  var margin = {
    top: 50,
    bottom: 50,
    left: 50, // Adjusted to accommodate longer x-axis labels
    right: 50,
  };
  var width = w - margin.left - margin.right;
  var height = h - margin.top - margin.bottom;

  // Create container div for chart
  var container = d3
    .select("#" + containerId)
    .append("div")
    .classed("chart-container", true);

  // Create SVG container
  var svg = container.append("svg").attr("width", w).attr("height", h);

  // Append title
  svg
    .append("text")
    .attr("x", w / 2)
    .attr("y", margin.top / 2)
    .attr("text-anchor", "middle")
    .style("font-size", "20px")
    .text(title);

  // Define scales and axes
  var x = d3
    .scaleLinear()
    .domain([
      0,
      d3.max(data, function (d) {
        return d[0];
      }),
    ])
    .range([margin.left, width]);

  var y = d3
    .scaleLinear()
    .domain([
      0,
      d3.max(data, function (d) {
        return d[1];
      }),
    ])
    .range([height, margin.top]);

  var xAxis = d3.axisBottom().scale(x);
  var yAxis = d3.axisLeft().scale(y);

  // Append X axis
  svg
    .append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

  // Append Y axis
  svg
    .append("g")
    .attr("class", "y-axis")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(yAxis);

  // Append circles for data points
  svg
    .selectAll(".circle")
    .data(data)
    .enter()
    .append("circle")
    .attr("class", "circle")
    .attr("cx", function (d) {
      return x(d[0]);
    }) // x-coordinate
    .attr("cy", function (d) {
      return y(d[1]);
    }) // y-coordinate
    .attr("r", 5) // radius of the circle
    .attr("fill", "none")
    .attr("stroke", "steelblue")
    .attr("stroke-width", 2)
    .on("mouseover", function () {
      d3.select(this).attr("stroke", "red");
    })
    .on("mouseout", function () {
      d3.select(this)
        .transition("colorfade")
        .duration(250)
        .attr("stroke", "steelblue");
    });

  // Append tooltips
  svg
    .selectAll(".circle")
    .append("title")
    .text(function (d) {
      return (
        "Floor Area: " +
        d[0] +
        " sqm, Average Resale Price: $" +
        d[1].toFixed(2)
      );
    });

  // Calculate linear regression parameters
  var regressionParams = calculateLinearRegression(data);

  // Calculate predicted y-values using linear regression
  var xValues = data.map(function (d) {
    return d[0];
  });
  var predictedYValues = xValues.map(function (x) {
    return regressionParams.intercept + regressionParams.slope * x;
  });

  // Append trendline
  svg
    .append("path")
    .datum(data)
    .attr("fill", "none")
    .attr("stroke", "black")
    .attr("stroke-width", 2)
    .attr(
      "d",
      d3
        .line()
        .x(function (d) {
          return x(d[0]);
        })
        .y(function (d, i) {
          return y(predictedYValues[i]);
        })
    );
      }
      
// Load data and create scatter plot

  // Convert value strings to numbers
  data.forEach(function (d) {
    d.resale_price = +d.resale_price;
    d.floor_area_sqm = +d.floor_area_sqm;
  });

  // Calculate average resale price for each floor area sqm
  var averagePrices = calculateAverageResalePrice(data);

  // Create scatter plot for chart7
  createFloorAreaSqmPlot(
    averagePrices,
    "Average Resale Price vs. Floor Area Sqm",
    "chart7"
  );

// Function to create a line chart
var data1 = {{ data_json1 | safe }};
function createLeaseCommenceDateChart(data, title, containerId) {
  var w = 700;
  var h = 500;
  var margin = {
    top: 50,
    bottom: 50,
    left: 50, // Adjusted to accommodate longer x-axis labels
    right: 50,
  };
  var width = w - margin.left - margin.right;
  var height = h - margin.top - margin.bottom;

  // Create container div for chart
  var container = d3.select("#" + containerId).append("div").classed("chart-container", true);

  // Create SVG container
  var svg = container
    .append("svg")
    .attr("width", w)
    .attr("height", h);

  // Append title
  svg.append("text")
    .attr("x", w / 2)
    .attr("y", margin.top / 2)
    .attr("text-anchor", "middle")
    .style("font-size", "20px")
    .text(title);

  // Define scales and axes
  var x = d3
    .scaleLinear()
    .domain([d3.min(data, function(d) { return d[0]; }), d3.max(data, function(d) { return d[0]; })])
    .range([margin.left, width]);

  var y = d3
    .scaleLinear()
    .domain([0, d3.max(data, function(d) { return d[1]; })])
    .range([height, margin.top]);

  var xAxis = d3.axisBottom().scale(x).tickFormat(d3.format("d"));
  var yAxis = d3.axisLeft().scale(y);

  // Append X axis
  svg.append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

  // Append Y axis
  svg.append("g")
    .attr("class", "y-axis")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(yAxis);

  // Define line function
  var line = d3.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y(d[1]); });

  // Append line
  svg.append("path")
    .datum(data)
    .attr("fill", "none")
    .attr("stroke", "steelblue")
    .attr("stroke-width", 2)
    .attr("d", line);

  // Append tooltips
  svg.selectAll(".dot")
    .data(data)
    .enter().append("circle")
    .attr("class", "dot")
    .attr("cx", function(d) { return x(d[0]); })
    .attr("cy", function(d) { return y(d[1]); })
    .attr("r", 5)
    .attr("fill", "steelblue")
    .on("mouseover", function(d) {
      d3.select(this).attr("fill", "red");
    })
    .on("mouseout", function(d) {
      d3.select(this).transition("colorfade")
        .duration(250)
        .attr("fill", "steelblue");
    });

  // Append tooltips
  svg.selectAll(".dot")
    .append("title")
    .text(function(d) { return d[0] + ": $" + d[1].toFixed(2); });
}

// Load data and create line charts


  // Convert value strings to numbers
  data.forEach(function(d) {
    d.lease_commence_date = +d.lease_commence_date;
    d.resale_price = +d.resale_price;
  });

  // Calculate average resale price for each lease commence date
  var averagePrices = d3.rollups(
    data,
    (v) => d3.mean(v, (d) => d.resale_price),
    (d) => d.lease_commence_date
  );

  // Sort averagePrices by lease commence date
  averagePrices.sort(function(a, b) {
    return d3.ascending(a[0], b[0]);
  });

  // Create line chart for chart1
  createLeaseCommenceDateChart(averagePrices, "Average Resale Price vs. Lease Commence Date", "chart5");
  // Function to create a line chart
function createRemainingLeaseChart(data1, title, containerId) {
  var w = 700;
  var h = 500;
  var margin = {
    top: 50,
    bottom: 50,
    left: 50, // Adjusted to accommodate longer x-axis labels
    right: 50,
  };
  var width = w - margin.left - margin.right;
  var height = h - margin.top - margin.bottom;

  // Create container div for chart
  var container = d3.select("#" + containerId).append("div").classed("chart-container", true);

  // Create SVG container
  var svg = container
    .append("svg")
    .attr("width", w)
    .attr("height", h);

  // Append title
  svg.append("text")
    .attr("x", w / 2)
    .attr("y", margin.top / 2)
    .attr("text-anchor", "middle")
    .style("font-size", "20px")
    .text(title);

  // Define scales and axes
  var x = d3
    .scaleLinear()
    .domain([d3.min(data1, function(d) { return d[0]; }), d3.max(data1, function(d) { return d[0]; })])
    .range([margin.left, width]);

  var y = d3
    .scaleLinear()
    .domain([0, d3.max(data1, function(d) { return d[1]; })])
    .range([height, margin.top]);

  var xAxis = d3.axisBottom().scale(x).tickFormat(d3.format("d"));
  var yAxis = d3.axisLeft().scale(y);

  // Append X axis
  svg.append("g")
    .attr("class", "x-axis")
    .attr("transform", "translate(0," + height + ")")
    .call(xAxis);

  // Append Y axis
  svg.append("g")
    .attr("class", "y-axis")
    .attr("transform", "translate(" + margin.left + ",0)")
    .call(yAxis);

  // Define line function
  var line = d3.line()
    .x(function(d) { return x(d[0]); })
    .y(function(d) { return y(d[1]); });

  // Append line
  svg.append("path")
    .datum(data1)
    .attr("fill", "none")
    .attr("stroke", "steelblue")
    .attr("stroke-width", 2)
    .attr("d", line);

  // Append tooltips
  svg.selectAll(".dot")
    .data(data1)
    .enter().append("circle")
    .attr("class", "dot")
    .attr("cx", function(d) { return x(d[0]); })
    .attr("cy", function(d) { return y(d[1]); })
    .attr("r", 5)
    .attr("fill", "steelblue")
    .on("mouseover", function(d) {
      d3.select(this).attr("fill", "red");
    })
    .on("mouseout", function(d) {
      d3.select(this).transition("colorfade")
        .duration(250)
        .attr("fill", "steelblue");
    });

  // Append tooltips
  svg.selectAll(".dot")
    .append("title")
    .text(function(d) { return d[0] + " Years: $" + d[1].toFixed(2); });
}

// Load data and create line charts


  // Convert value strings to numbers
  data1.forEach(function(d) {
    d.remaining_lease = +d.remaining_lease;
    d.resale_price = +d.resale_price;
  });

  // Calculate average resale price for each lease commence date
  var averagePrices = d3.rollups(
    data1,
    (v) => d3.mean(v, (d) => d.resale_price),
    (d) => d.remaining_lease
  );

  // Sort averagePrices by lease commence date
  averagePrices.sort(function(a, b) {
    return d3.ascending(a[0], b[0]);
  });

  // Create line chart for chart1
  createLeaseCommenceDateChart(averagePrices, "Average Resale Price vs. Remaining Lease (Years)", "chart6");



</script>

  {% endblock %}
  {% set active_tab = 'price' %}